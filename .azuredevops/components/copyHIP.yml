parameters:
- name: aptPackages
  type: string
  default: 'libnuma-dev mesa-common-dev'
- name: pipModules
  type: string
  default: 'CppHeaderParser'

# hip and clr are tightly-coupled
# run this same template for both repos
# any changes for clr should just trigger HIP pipeline
jobs:
- job: hip_clr_combined
  variables:
  - group: common
  - template: /.azuredevops/variables-global.yml
  pool:
    vmImage: ${{ variables.LOW_END_BUILD_POOL }}
  workspace:
    clean: all
  steps:
# checkout nothing, just copy artifacts from triggering HIP job
# and then publish for this clr job to maintain latest
  - checkout: none
  - template: ${{ variables.CI_TEMPLATE_PATH }}/steps/artifact-download.yml
    parameters:
      componentName: HIP
      branchName: develop
  - template:  ${{ variables.CI_TEMPLATE_PATH }}/steps/artifact-prepare-package.yml
    parameters:
      sourceDir: $(Agent.BuildDirectory)/rocm
  - template: ${{ variables.CI_TEMPLATE_PATH }}/steps/artifact-upload.yml
